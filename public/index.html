<!doctype html><html lang=en><head><meta name=generator content="Hugo 0.75.1"><meta charset=utf-8><title>Anirudh's Internship Presentation</title><meta name=apple-mobile-web-app-capable content="yes"><meta name=apple-mobile-web-app-status-bar-style content="black-translucent"><meta name=viewport content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=no"><link rel=stylesheet href=/qs-intern-talk/reveal-js/css/reset.css><link rel=stylesheet href=/qs-intern-talk/reveal-js/css/reveal.css><link rel=stylesheet href=/qs-intern-talk/_.min.e09da0add54a00a3c4d82915132d9593c6a2626845f2bcebddc837585cf8b2a6.css id=theme><link rel=stylesheet href=/qs-intern-talk/highlight-js/monokai-sublime.min.css></head><body><div class=reveal><div class=slides><section><h1 id=array-libraries-interoperability>Array Libraries Interoperability</h1><p>Anirudh Dagar</p><p><p class=social-author>@anirudhdagar</p><p class=social-author>@gollum_here</p><a href=https://www.github.com/anirudhdagar target=_blank><span class="icon icon-github icon-left"></span></a><a href=https://www.twitter.com/gollum_here target=_blank><span class="icon icon-twitter"></span></a><div></div><a class=this-talk-link , href=https://github.com/anirudhdagar/qs-intern-talk target=_blank>This talk on Github: anirudhdagar/qs-intern-talk</a></p><figure><img src=images/labs.jpg height=60px></figure></section><section><div class="g g-middle"><div class=g-1><h1 id=array-providers>Array Providers</h1><p><span class=fragment>PyTorch</span></p><p><span class=fragment>NumPy</span></p><p><span class=fragment>CuPy</span></p><p><span class=fragment>MXNet</span></p><p><span class=fragment>JAX etc.</span></p></div><div class=g-1><h1 id=array-consumers>Array Consumers</h1><p><span class=fragment>SciPy</span></p><p><span class=fragment>Scikit-Learn</span></p><p><span class=fragment>Scikit-Image</span></p><p><span class=fragment>AstroPy</span></p><p><span class=fragment>EinOps etc.</span></p></div></div></section><section><blockquote><p>NumPy, CuPy, PyTorch or SciPy aren&rsquo;t gonna hit as hard as all of them when used together.
But it ain&rsquo;t about finding a way to use them individually; it&rsquo;s about making them work together.
That&rsquo;s how interoperable science is done.
<cite>Rocky Balboa</cite></p></blockquote><aside class=notes><p>Hopefully you&rsquo;ve seen this very popular boxing movie series &ldquo;Rocky&rdquo;.</p></aside></section><section><h2 id=try-using-non-numpy-with-scipy>Try using non-NumPy with SciPy</h2><pre><code class=language-python data-line-numbers=1-3|6|6-12># Estimate power spectral density using Welch’s method.
# SciPy offers a method `welch` for doing exactly that.
from scipy.signal import welch


freq, Pxx = welch(x)

# For CuPy
ValueError: object __array__ method not producing an array

# For PyTorch
TypeError: can't convert cuda:0 device type tensor to numpy.
</code></pre></section><section><h1 id=python-array-api>Python Array API</h1><ul><li><span class=fragment>Standard Array API across all array/tensor frameworks.</span></li><li><span class=fragment>NEP 47 or __array_namespace__ protocol</span></li><li><span class=fragment>https://data-apis.org/array-api/latest/</span></li></ul><aside class=notes><p>The APIs of each of these libraries are largely similar, but with enough differences that it’s quite difficult to write code that works with multiple (or all) of these libraries. This array API standard aims to address that issue, by specifying an API for the most common ways arrays are constructed and used.</p></aside></section><section><h1 id=python-array-api-use-case>Python Array API: Use Case</h1><ul><li><span class=fragment>add hardware accelerator and distributed support to SciPy</span></li><li><span class=fragment>simplify einops by removing the backend system</span></li></ul></section><section><h1 id=scipy-with-pytorch-tensors-demo>SciPy with PyTorch Tensors Demo</h1></section><section><h1 id=pytorch-contributions>PyTorch Contributions</h1><p>Improve Array API Compliance in PyTorch</p><ul><li><span class=fragment>torch.concat (PR #62560)</span></li><li><span class=fragment>torch.linalg.cross (PR #63285)</span></li><li><span class=fragment>torch.linalg.matmul (PR #63227)</span></li></ul></section><section><h1 id=uarray><code>uarray</code></h1><ul><li><span class=fragment>backend / dispatch mechanism</span></li><li><span class=fragment>separately define an API; backends contain separate implementations of that API.</span></li><li><span class=fragment>user can register an implementation</span></li></ul></section><section><h1 id=uarray-tracker--issue-14353>uarray Tracker : Issue #14353</h1><ul><li><p><input checked disabled type=checkbox> <code>scipy.fft</code> <a href=https://github.com/scipy/scipy/pull/10383>PR #10383</a> (Thanks <a href=https://github.com/peterbell10>@peterbell10</a>!)</p></li><li><p><input disabled type=checkbox> <code>scipy.ndimage</code> <a href=https://github.com/scipy/scipy/pull/14356>PR #14356</a></p><ul><li><input disabled type=checkbox> Filters</li><li><input disabled type=checkbox> Fourier filters</li><li><input disabled type=checkbox> Interpolation</li><li><input disabled type=checkbox> Measurements</li><li><input disabled type=checkbox> Morphology</li></ul></li><li><p><input disabled type=checkbox> <code>scipy.linalg</code> <a href=https://github.com/scipy/scipy/pull/14407>PR #14407</a> (Thanks <a href=https://github.com/czgdp1807>@czgdp1807</a>!)</p></li><li><p><input disabled type=checkbox> <code>scipy.special</code></p></li></ul><aside class=notes><p>SciPy currently supports this through the <code>scipy.fft</code> module.
There are other scipy modules that will benefit from <code>uarray</code> backend, and later extending the usage through libraries like <code>CuPy</code> (<a href=https://github.com/cupy/cupy/tree/master/cupyx/scipy>cupyx.scipy</a>) and <code>Dask</code> (<a href=https://github.com/dask/dask/tree/main/dask/array>dask.array</a>) etc.</p></aside></section><section><p>SciPy uarray ndimage PR: <a href=https://github.com/scipy/scipy/pull/14356>https://github.com/scipy/scipy/pull/14356</a></p><pre><code class=language-python data-line-numbers=1-3|5|5-7># SciPy ndimage with CuPy array
from scipy import ndimage
import cupy as cp

with scipy.ndimage.set_backend('cupy'):
    y_cupy = ndimage.correlate1d(cp.arange(10),
                                 cp.array([1, 2.5]))
</code></pre></section><section><h1 id=uarray-demo-scipy-with-cupy-arrays>uarray Demo: SciPy with CuPy Arrays</h1></section><section><h1 id=thanks>Thanks!</h1><div class="g g-middle"><div class=g-1><figure><img src=images/quansight_logo_white.png height=280px></figure></div><div class=g-1><p>Anirudh Dagar</p><p class=social-author>@anirudhdagar</p><p class=social-author>@gollum_here</p><a href=https://www.github.com/anirudhdagar target=_blank><span class="icon icon-github icon-left"></span></a><a href=https://www.twitter.com/gollum_here target=_blank><span class="icon icon-twitter"></span></a><div></div><a class=this-talk-link , href=https://github.com/anirudhdagar/qs-intern-talk target=_blank>This talk on Github: anirudhdagar/qs-intern-talk</a></div></div><aside class=notes><p>Special mention to my very supportive mentor Ralf Gommers (@rgommers) for making everything possible since day 1.
I couldn&rsquo;t have asked for more, got lucky with a mentor like Ralf. Thank you so very much.</p><p>Melissa (@melissawm) and the whole team behind the internship program.</p><p>Gregory R. Lee (@grlee77) and Peter Bell (@peterbell10) for the guidance with <code>uarray</code>.
Whole PyTorch team who have been super super helpful in sharing their knowledge and insights on contributing to PyTorch.</p><p>I&rsquo;ve mentioned this several times in the past, I plan to continue my open source journey in SciPy and PyTorch and hopefully
keep collaborating with the amazing folks in Quansight.</p></aside></section></div></div><script type=text/javascript src=/qs-intern-talk/reveal-hugo/object-assign.js></script><a href=/qs-intern-talk/reveal-js/css/print/ id=print-location style=display:none></a><script type=text/javascript>var printLocationElement=document.getElementById('print-location');var link=document.createElement('link');link.rel='stylesheet';link.type='text/css';link.href=printLocationElement.href+(window.location.search.match(/print-pdf/gi)?'pdf.css':'paper.css');document.getElementsByTagName('head')[0].appendChild(link);</script><script type=application/json id=reveal-hugo-site-params>{"custom_theme":"custom-theme.scss","custom_theme_compile":true,"height":720,"highlight_theme":"monokai-sublime","transition_speed":"fast","width":1280}</script><script type=application/json id=reveal-hugo-page-params>null</script><script src=/qs-intern-talk/reveal-js/js/reveal.js></script><script type=text/javascript>function camelize(map){if(map){Object.keys(map).forEach(function(k){newK=k.replace(/(\_\w)/g,function(m){return m[1].toUpperCase()});if(newK!=k){map[newK]=map[k];delete map[k];}});}
return map;}
var revealHugoDefaults={center:true,controls:true,history:true,progress:true,transition:"slide"};var revealHugoSiteParams=JSON.parse(document.getElementById('reveal-hugo-site-params').innerHTML);var revealHugoPageParams=JSON.parse(document.getElementById('reveal-hugo-page-params').innerHTML);var options=Object.assign({},camelize(revealHugoDefaults),camelize(revealHugoSiteParams),camelize(revealHugoPageParams));Reveal.initialize(options);</script><script type=text/javascript src=/qs-intern-talk/reveal-js/plugin/markdown/marked.js></script><script type=text/javascript src=/qs-intern-talk/reveal-js/plugin/markdown/markdown.js></script><script type=text/javascript src=/qs-intern-talk/reveal-js/plugin/highlight/highlight.js></script><script type=text/javascript src=/qs-intern-talk/reveal-js/plugin/zoom-js/zoom.js></script><script type=text/javascript src=/qs-intern-talk/reveal-js/plugin/notes/notes.js></script><script>MathJax={tex:{inlineMath:[['$','$'],['\\(','\\)']]},svg:{fontCache:'global'}};</script><script type=text/javascript id=MathJax-script async src=https://anirudhdagar.github.io/qs-intern-talk//javascript/tex-svg.js></script><link rel="shortcut icon" href=https://anirudhdagar.github.io/qs-intern-talk//favicon.ico></body></html>